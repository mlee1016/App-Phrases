<!-- Top Navigation -->
<header class="fixed top-14 left-20 right-2 bg-gray-900 text-cyan-200 px-6 py-4 shadow-md z-10 flex justify-between items-center rounded-md">
  <h1 class="text-2xl font-bold tracking-wide">{{id}}</h1>
  <button *ngIf="status2()==='signed in'" (click)="clearCompleted()" class="bg-red-700 hover:bg-red-800 text-white text-sm font-semibold px-4 py-2 rounded">
  🧹 Clear
</button>

  <!-- Completion Status --> 
  <div *ngIf="selectedPhraseName()!=null " class="text-sm">
    <ng-container *ngIf="phrase_ind()['name']=='s'">
      <span class="font-semibold text-blue-300">{{allStory[phrase_ind()['ind']].s}}</span> 
      <span *ngIf="status==='signed in'" [class.text-green-400]="allStory[phrase_ind()['ind']].isDone" [class.text-red-400]="!allStory[phrase_ind()['ind']].isDone">
       : {{allStory[phrase_ind()['ind']].isDone ? 'Completed!' : 'Not Completed'}}
      </span>
    </ng-container>

    <ng-container *ngIf="phrase_ind()['name']=='c'">
      <span class="font-semibold text-green-300">{{allCourse[phrase_ind()['ind']].s}}</span> 
      
      <span *ngIf="status==='signed in'" [class.text-green-400]="allCourse[phrase_ind()['ind']].isDone" [class.text-red-400]="!allCourse[phrase_ind()['ind']].isDone">
       : {{allCourse[phrase_ind()['ind']].isDone ? 'Completed!' : 'Not Completed'}}
      </span>
    </ng-container>
  </div>

  <!-- Controls -->
  <div class="flex items-center gap-3">
    <button (click)="togglePanel()" class="bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold px-4 py-2 rounded">
      {{ isPanelOpen ? 'Hide Sections' : 'Show Sections' }}
    </button>

    <button *ngIf="selectedPhraseName()!==null && status2()==='signed in'" (click)="toggleCompleteConfirm()" class="bg-green-600 hover:bg-green-700 text-white text-sm font-semibold px-4 py-2 rounded">
      ✅ Complete
    </button>
  </div>
</header>

<!-- Completion Confirmation Modal -->
<div *ngIf="showCompleteConfirm && status2() ==='signed in' " class="fixed top-50 left-[27rem] bg-gray-800 text-cyan-200 p-5 rounded shadow-lg w-[22rem] z-20 border border-cyan-400">
  <h2 class="text-lg font-bold mb-3">✔ Mark as Completed?</h2>

  <label class="flex items-center gap-2 mb-4">
    <input type="checkbox" [(ngModel)]="isCompleted" class="form-checkbox text-cyan-500" />
    <span>Yes, I've completed this phrase.</span>
  </label>

  <div class="flex justify-end gap-3">
    <button (click)="saveCompleted()" class="bg-teal-600 hover:bg-teal-700 px-4 py-1 rounded text-white font-semibold">Save</button>
    <button (click)="toggleCompleteConfirm()" class="bg-red-500 hover:bg-red-600 px-4 py-1 rounded text-white font-semibold">Cancel</button>
  </div>
</div>

<!-- Slide-down Panel -->
<div class="bg-gray-900 transition-all duration-300 ease-in-out overflow-hidden fixed top-[6.5rem] left-20 right-2 z-0 border-t border-cyan-400 rounded-b-md"
     [style.maxHeight]="isPanelOpen ? '350px' : '0px'">
  <div class="grid grid-cols-1 md:grid-cols-3 h-[350px] divide-x divide-gray-700">
    

    

    <!-- Table of Content -->
    <div class="p-4 overflow-y-auto">
      <h2 class="text-xl font-semibold text-purple-400 mb-3">📑 Table of Contents</h2>
      <ul class="space-y-2">
        <li *ngFor="let toc of theCourse;let i = index"
            class="cursor-pointer hover:text-purple-300 transition"
            
             (click)="show2()" >

            
            {{ toc.category }}
            <span *ngFor="let a of toc.lessons"><p *ngIf="showlessons" class="text-purple-200">{{a.phrase}} : {{a.en}} </p></span>
        </li>
      </ul>
    </div>

    
    <!-- Course -->
    <div class="p-4 overflow-y-auto">
      <h2 class="text-xl font-semibold text-green-400 mb-3">🎓 Course</h2>
      <ul class="space-y-2">

        <li *ngFor="let course of allCourse; let i = index"
          class="cursor-pointer transition hover:text-green-300"
          [ngClass]="{
          'text-green-400 font-semibold': course.isDone,
          'text-green-200': !course.isDone
          }"
          (click)="aPhrase(course.s, i, 'c')">
            {{ course.s }}
        </li>

      </ul>
    </div>
    <!-- Story -->
    <div class="p-4 overflow-y-auto">
      <h2 class="text-xl font-semibold text-blue-400 mb-3">📘 Story</h2>
      <ul class="space-y-2">
        
        <li *ngFor="let story of allStory; let i = index"
          class="cursor-pointer transition hover:text-blue-300"
          [ngClass]="{
          'text-green-400 font-semibold': story.isDone,
          'text-blue-200': !story.isDone
            }"
          (click)="aPhrase(story.s, i, 's')">
            {{ story.s }}
        </li>

      </ul>
    </div>


  </div>
</div>

<!-- Phrase Cards Grid -->
<main class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 p-6 mt-[6.5rem]">
  <!-- <div *ngIf="phrases.length > 0; else loading"> -->
  <div *ngFor="let item of phrases(); let i = index"
        [ngClass]="{
          'bg-gray-950 border-emerald-400': getDoneStatus(),
          'bg-cyan-900 border-cyan-500': !getDoneStatus()
        }"

       class="border rounded-xl p-4 shadow-md text-white hover:shadow-lg transition duration-300">
    
    <div class="text-lg font-bold text-cyan-300 mb-1"><span [innerHTML]="formatPhrase(item.phrase)"></span></div>
    <div class="text-sm italic text-gray-400"><span [innerHTML]="formatPhrase(item.pr)"></span></div>
    <div class="text-sm text-emerald-300 mt-1"><span [innerHTML]="formatPhrase(item.en)"></span></div>
    <div class="text-xs italic text-gray-500 mt-1">{{ item.des }}</div>
    <div class="text-xs mt-2 text-cyan-500">{{ item.phrase_name }}</div>

    <!-- Uncomment to add Edit button -->
    <!--
    <button (click)="openEdit(i)"
            class="mt-3 bg-cyan-700 hover:bg-cyan-600 text-white px-3 py-1 rounded shadow-sm">
      ✏️ Edit
    </button>
    -->

  </div>

  <!--<div>
    <button class="px-5 py-2 bg-green-600 border-green-400 border rounded correct-pop">a</button>
    <button class="px-5 py-2 bg-red-600 border-red-400 border rounded wrong-s m-6">b</button>
    <button class="px-5 py-2 bg-cyan-600 border-cyan-400 border rounded confetti"></button> 
    <button class="px-5 py-2 bg-cyan-600 border-cyan-400 border rounded confetti"></button>  
    <button class="px-5 py-2 bg-cyan-600 border-cyan-400 border rounded confetti"></button>  
    <button class="px-5 py-2 bg-cyan-600 border-cyan-400 border rounded confetti"></button>
    <button class="px-5 py-2 bg-green-600 border-green-400 border rounded correct-glow m-6">a</button>
    <button class="px-5 py-2 bg-green-600 border-green-400 border rounded correct-s">b</button>
    <button class="px-5 py-2 bg-indigo-600 border-indigo-400 border rounded show-wiggle m-6">c</button>


  </div>-->

  
</main>
