<!-- Top Navigation -->
<header
  class="p-3 md:p-4 bg-gray-900 text-cyan-200 shadow-md z-10 flex justify-between items-center rounded-md">
  
  <h1 class="text-2xl font-bold tracking-wide">{{ id }}</h1>

  <button
    *ngIf="status2() === 'signed in'"
    (click)="clearCompleted()"
    class="bg-red-700 hover:bg-red-800 text-white text-sm font-semibold px-4 py-2 rounded">
    ðŸ§¹ Clear
  </button>

  <div *ngIf="selectedPhraseName() != null" class="text-sm">
    <ng-container *ngIf="phrase_ind()['name'] == 's'">
      <span class="font-semibold text-blue-300">
        {{ allStory[phrase_ind()['ind']].s }}
      </span>
      <span
        *ngIf="status === 'signed in'"
        [class.text-green-400]="allStory[phrase_ind()['ind']].isDone"
        [class.text-red-400]="!allStory[phrase_ind()['ind']].isDone">
        : {{ allStory[phrase_ind()['ind']].isDone ? 'Completed!' : 'Not Completed' }}
      </span>
    </ng-container>

    <ng-container *ngIf="phrase_ind()['name'] == 'c'">
      <span class="font-semibold text-green-300">
        {{ allCourse[phrase_ind()['ind']].s }}
      </span>
      <span
        *ngIf="status === 'signed in'"
        [class.text-green-400]="allCourse[phrase_ind()['ind']].isDone"
        [class.text-red-400]="!allCourse[phrase_ind()['ind']].isDone">
        : {{ allCourse[phrase_ind()['ind']].isDone ? 'Completed!' : 'Not Completed' }}
      </span>
    </ng-container>
    <ng-container *ngIf="phrase_ind()['name'] == 'p'">
      <span class="font-semibold text-purple-300">
        {{ allPopular[phrase_ind()['ind']].s }}
      </span>
      <span
        *ngIf="status === 'signed in'"
        [class.text-green-400]="allPopular[phrase_ind()['ind']].isDone"
        [class.text-red-400]="!allPopular[phrase_ind()['ind']].isDone">
        : {{ allPopular[phrase_ind()['ind']].isDone ? 'Completed!' : 'Not Completed' }}
      </span>
      </ng-container>
  </div>

  <div class="flex items-center gap-3">
    <button
      (click)="togglePanel()"
      class=" text-white text-sm font-semibold px-4 py-2 rounded fade-slide-btn border border-cyan-400 hover:bg-cyan-700 transition">
      {{ isPanelOpen ? 'Hide Sections' : 'Show Sections' }}
    </button>

    <button
      *ngIf="selectedPhraseName() !== null && status2() === 'signed in'"
      (click)="toggleCompleteConfirm()"
      class="bg-green-600 hover:bg-green-700 text-white text-sm font-semibold px-4 py-2 rounded">
      âœ… Complete
    </button>
  </div>
</header>
<div
  class="panel-container bg-gray-900 border-t border-cyan-400 rounded-b-2xl shadow-2xl 
         transition-all duration-700 ease-in-out overflow-hidden z-0"
  [style.maxHeight]="isPanelOpen ? '380px' : '0px'">

  <div class="grid grid-cols-1 md:grid-cols-4 h-[380px] divide-x divide-gray-800 animate-fadeIn">
    
    <!-- Table of Content -->
    <div class="section p-5 overflow-y-auto">
      <h2 class="section-title text-cyan-200 mb-4">ðŸ“‘ Table of Contents</h2>
      <ul class="space-y-2">
        <li *ngFor="let toc of theCourse; let i = index"
    class="list-item"
    (click)="show3(i)">
  {{ toc.category }} 

  <div *ngIf="activeIndex === i" class="ml-2 border-l border-cyan-700 pl-3 mt-2 space-y-1">
    <p *ngFor="let a of toc.lessons" class="lesson-item">
      {{ a.phrase }} <span class="text-gray-400">â€” {{ a.en }}</span>
    </p>
  </div>
</li>

      </ul>
    </div>

    <!-- Course -->
    <div class="section p-5 overflow-y-auto">
      <h2 class="section-title text-green-400 mb-4">ðŸŽ“ Course</h2>
      <ul class="space-y-2">
        <li *ngFor="let course of allCourse; let i = index"
            class="list-item text-green-200 hover:text-green-300"
            [ngClass]="{'active-item': course.isDone}"
            (click)="aPhrase(course.s, i, 'c')">
          {{ course.s }}
        </li>
      </ul>
    </div>

    <!-- Popular Phrases -->
    <div class="section p-5 overflow-y-auto">
      <h2 class="section-title text-blue-400 mb-4">ðŸ’¬ Popular Phrases</h2>
      <ul class="space-y-2">
        <li *ngFor="let pop of allPopular; let i = index"
            class="list-item text-blue-200 hover:text-blue-300"
            [ngClass]="{'active-item': pop.isDone}"
            (click)="aPhrase(pop.s, i, 'p')">
          {{ pop.s }}
        </li>
      </ul>
    </div>

    <!-- Story -->
    <div class="section p-5 overflow-y-auto">
      <h2 class="section-title text-purple-400 mb-4">ðŸ“˜ Story</h2>
      <ul class="space-y-2">
        <li *ngFor="let story of allStory; let i = index"
            class="list-item text-purple-200 hover:text-purple-300"
            [ngClass]="{'active-item': story.isDone}"
            (click)="aPhrase(story.s, i, 's')">
          {{ story.s }}
        </li>
      </ul>
    </div>
  </div>
</div>


<!-- Phrase Cards Grid -->
<main *ngIf="selectedPhraseName()!=null else howTo" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 p-6 mt-[6.5rem] ml-[5rem]">
  <div
    *ngFor="let item of phrases(); let i = index"
    [ngClass]="{
      'bg-gray-950 border-emerald-400': getDoneStatus(),
      'bg-cyan-900 border-cyan-500': !getDoneStatus()
    }"
    class="border rounded-xl p-4 shadow-md text-white hover:shadow-lg transition duration-300">
    
    <div class="text-lg font-bold text-cyan-300 mb-1">
      <span [innerHTML]="formatPhrase(item.phrase)"></span>
    </div>
    <div class="text-sm italic text-gray-400">
      <span [innerHTML]="formatPhrase(item.pr)"></span>
    </div>
    <div class="text-sm text-emerald-300 mt-1">
      <span [innerHTML]="formatPhrase(item.en)"></span>
    </div>
    <div class="text-xs italic text-gray-500 mt-1">{{ item.des }}</div>
    <div class="text-xs mt-2 text-cyan-500">{{ item.phrase_name }}</div>
  </div>
</main>

<ng-template #howTo>
  <div class="flex flex-col items-center justify-center min-h-screen px-4 py-8 text-center overflow-y-auto sm:overflow-visible">
    <!-- ðŸŒŸ Welcome Section -->
<section class="max-w-2xl w-full mx-auto bg-gray-900/40 backdrop-blur-sm rounded-2xl p-8 sm:p-10 shadow-lg border border-cyan-800/40 text-center animate-fadeInUp">
  <h1 class="text-3xl sm:text-4xl font-extrabold text-cyan-200 mb-3 tracking-wide">
    Welcome to <span class="text-emerald-300">Phrase Itera</span>!
  </h1>
  <p class="text-cyan-400 text-base sm:text-lg mb-2">
    Choose a phrase list from the sections above to start exploring.
  </p>
  <p class="text-cyan-500 text-sm sm:text-base mb-8">
    Once selected, youâ€™ll see a preview of structured phrases with pronunciation, meaning, and grammar details.
  </p>

  <!-- ðŸ“˜ Section Overview -->
  <div class="bg-gray-800/60 rounded-xl p-6 mb-8 text-left sm:text-center border border-cyan-700/30 shadow-inner">
    <h2 class="text-2xl font-bold text-cyan-200 mb-3">Sections Overview</h2>
    <ul class="space-y-4 text-cyan-400 text-base sm:text-lg list-disc list-inside sm:list-none">
      <li>
        <span class="text-emerald-300 font-semibold">ðŸ“— Course / Table of Contents:</span>
        Organized by grammar points â€” learn structure, usage, and related phrases.
      </li>
      <li>
        <span class="text-indigo-300 font-semibold">ðŸ’¬ Popular Phrases:</span>
        Everyday conversation phrases to use in real-life situations.
      </li>
      <li>
        <span class="text-rose-300 font-semibold">ðŸ“– Story Mode:</span> 
        Learn through context and storytelling to deepen understanding.
      </li>
    </ul>
  </div>

  <!-- ðŸ§­ Study Areas -->
  <div class="bg-cyan-900/30 border border-cyan-700 rounded-xl p-6 shadow-md text-left sm:text-center">
    <h2 class="text-2xl text-cyan-200 font-semibold mb-4">Places to Study</h2>
    <ul class="text-cyan-300 space-y-3 text-sm sm:text-base list-disc list-inside sm:list-none">
      <li>
        <span class="text-indigo-300 font-semibold">ðŸ’¬ Popular Phrases:</span>
        <span class="text-emerald-200">card, multiple choice, speech</span>
      </li>
      <li>
        <span class="text-emerald-300 font-semibold">ðŸ“˜ Course Phrases:</span>
        <span class="text-emerald-200">type-in, card, multiple choice, speech, fill-in-the-blank</span>
      </li>
      <li>
        <span class="text-rose-300 font-semibold">ðŸ“– Story Phrases:</span>
        <span class="text-emerald-200">type-in, card, multiple choice, speech, chat</span>
      </li>
    </ul> 
  </div>

  <p class="text-cyan-400 mt-8 text-xs italic">
    ðŸ’¡ Tip: Works best in modern browsers like <span class="text-emerald-300">Chrome</span> and <span class="text-emerald-300">Edge</span> for full audio and speech features.
  </p>
</section>

  </div>
</ng-template>
