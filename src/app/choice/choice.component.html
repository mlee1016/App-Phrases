
<!----
<header class="flex justify-between items-center p-4 bg-[#0F1F26] shadow-md text-cyan-100">
  <h2 class="text-lg md:text-xl font-bold">
    {{ inputh() === '' ? 'üìö Pick a list ‚Üí' : 'Currently studying: ' + inputh() }}
  </h2>
  <button
    (click)="toggleSidebar()"
    class="bg-cyan-500 hover:bg-cyan-400 text-black px-3 py-2 rounded-lg shadow transition"
  >
    {{ sideBar ? '‚úñ Close' : '‚ò∞ Menu' }}
  </button>
</header>
<div *ngIf="sideBar" class="fixed inset-0 bg-black bg-opacity-60 z-40 flex items-center justify-center">
  
  <!-- MODAL PANEL --
  <div class="bg-cyan-950 text-white w-[90%] max-w-lg rounded-lg shadow-xl p-6 space-y-6 z-50 animate-fade-in mt-[4rem] overflow-y-auto max-h-[80vh]">
    
    <!-- Close Button --
    <div class="text-right">
      <button
        class="text-sm bg-cyan-800 hover:bg-cyan-700 text-white px-3 py-1 rounded"
        (click)="close2()"
      > 
        ‚úñ Close
      </button>
    </div>

    <!-- Lists Section --
    <div>
      <h2  class="text-xl font-bold mb-2 ">{{inputh()===''?'pick a phrase': 'selected: ' + inputh()}}</h2>
      <h2 class="text-lg font-bold mb-2 border-b border-cyan-600 pb-1">Lists</h2>
      <div class="flex flex-col gap-2 overflow-y-scroll h-[15rem]">
        <button
          *ngFor="let item of allgrammer"
          (click)="getSpecificPhrases(item.s)"
          class="hover:bg-cyan-600 text-white px-3 py-2 rounded transition"
          [ngClass]="item.isDone ? 'bg-blue-600' : 'bg-cyan-700'"
        >
                
          
        
        
        
        {{ item.s }}

        </button>
      </div>
    </div>

    <!-- Story Section --
    <div>
      <h2 class="text-lg font-bold mt-4 mb-2 border-b border-cyan-600 pb-1">Story</h2>
      <div class="flex flex-col gap-2 overflow-y-scroll h-[15rem]">
        <button
          *ngFor="let item of allStory"
          (click)="getSpecificPhrases(item.s)"
          class="hover:bg-cyan-500 text-white px-3 py-2 rounded transition"
          [ngClass]="item.isDone ? 'bg-[#0f765e]' : 'bg-cyan-500'"
        >
                {{ item.s}}

        </button>
      </div>
    </div>

  </div>
</div>-->

<header class="flex justify-between items-center p-4 bg-[#0F1F26] shadow-md text-cyan-100">

  <h2 class="text-lg md:text-xl font-bold">
    {{ inputh() === '' ? 'üìö Pick a list ‚Üí' : 'Currently studying: ' + inputh() }}
  </h2>
  <button
  
    (click)="toggleSidebar()"
    class="bg-cyan-500 hover:bg-cyan-400 text-white px-3 py-2 rounded-lg shadow transition"
  >
    {{ sideBar ? '‚úñ Close' : '‚ò∞ Menu' }}
  </button>
</header>
<!-- BACKDROP --
<div *ngIf="sideBar" class="fixed inset-0 bg-grey-700 bg-opacity-60 z-40 flex items-center justify-center ">
  
  <!-- MODAL PANEL --


  <div class="bg-cyan-950 text-white w-[90%] max-w-lg rounded-lg shadow-xl p-6 space-y-6 z-50 animate-fade-in overflow-y-auto max-h-[80vh]">

    
    <!-- Close Button --
    <div class="text-right">
      <button
        class="text-sm bg-cyan-800 hover:bg-cyan-700 text-white px-3 py-1 rounded"
        (click)="close2()"
      >
        ‚úñ Close
      </button>
    </div>
    <h2  class="text-xl font-bold mb-2 ">{{inputh()===''?'pick a phrase': 'selected: ' + inputh()}}</h2>

    <!-- Story Section --
    <div *ngIf="m1==='course'" class="overflow-y-auto max-h-80">
      
      <h2 class="text-lg font-bold mt-4 mb-2 border-b border-cyan-600 pb-1">Lists</h2>
      <div class="flex flex-col gap-2">
        <button
          *ngFor="let item of allgrammer"
          (click)="getSpecificPhrases(item.s)"
          class="hover:bg-cyan-600 text-white px-3 py-2 rounded transition"
          [ngClass]="item.isDone ? 'bg-blue-600' : 'bg-cyan-700'"
        >
          {{ item.s }}


        </button>
      </div>
    </div>
    <div *ngIf="m1==='popular'" class="overflow-y-auto max-h-80">
      <!-- Popular Phrases --
      <h2 class="text-lg font-bold mt-4 mb-2 border-b border-cyan-600 pb-1">Popular/Useful</h2>
      <div class="flex flex-col gap-2">
        <button
          *ngFor="let item of allPopular"
          (click)="getSpecificPhrases(item.s)"
          class="hover:bg-cyan-500 text-white px-3 py-2 rounded transition"
          [ngClass]="item.isDone ? 'bg-[#0f765e]' : 'bg-cyan-500'"
        >
          {{ item.s }}
        </button>
      </div>
    </div>
    <div *ngIf="m1 ==='story'" class="overflow-y-auto max-h-80">
      <h2 class="text-lg font-bold mt-4 mb-2 border-b border-cyan-600 pb-1">Story</h2>
      <div class="flex flex-col gap-2">
        <button
          *ngFor="let item of allStory"
          (click)="getSpecificPhrases(item.s)"
          class="hover:bg-cyan-500 text-white px-3 py-2 rounded transition"
          [ngClass]="item.isDone ? 'bg-[#0f765e]' : 'bg-cyan-500'"
        >
          {{ item.s }}
        </button>
      </div>
    </div>

  </div>
</div>-->
 <app-s-model 
  [sideBar]="sideBar"
  [m1]="m1"
  [phraseCourse]="allgrammer"
  [phrasePopular]="allPopular"
  [phraseStory]="allStory"
  [selectedPhrases]="inputh"
  (closeModal)="close2()"
  (selectPhrase)="getSpecificPhrases($event)">
</app-s-model>

<!-- üåê QUIZ PAGE WRAPPER -->
<div class="min-h-screen  text-white flex flex-col justify-center items-center px-4 py-8 animate-fadeIn">

  <!-- üè∑Ô∏è Title -->
  <h2 class="text-3xl sm:text-4xl font-bold text-cyan-200 mb-6 text-center animate-slideDown">
    {{ id }}:Choice
  </h2>

  <!-- ‚ñ∂ Start Button Section -->
  <div *ngIf="isReadyToStart && !quizStarted" class="text-center space-y-4 animate-popIn">
    
  <button
    (click)="startQuiz()"
    class="bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 
    text-white px-10 py-3 rounded-xl shadow-lg text-lg font-semibold transition-all duration-200 hover:scale-105"
  >
    ‚ñ∂ Start
  </button>
    <div>
      <button (click)="toggleDirection()" 
              class="bg-blue-600 hover:bg-blue-700 active:scale-95 text-white px-4 py-2 rounded-md mt-2 transition-all duration-200">
        {{ direction === direction1 ? id + ' ‚Üí English' : 'English ‚Üí ' + id }}
      </button>
    </div>
    <div class="bg-white shadow-md rounded-2xl p-6 mx-auto max-w-md flex flex-col gap-4 hover:shadow-lg hover:-translate-y-0.5 transition">
  <h2 class="text-2xl font-bold text-slate-800 text-center">Multi</h2>
  <div class="text-slate-700 text-center">
    Study with multiple choice questions to test understanding.
  </div>
  <div class="bg-slate-100 text-slate-600 p-3 rounded-lg text-center">
    Practice with multiple-choice questions to test your grammar and phrase knowledge in context.
  </div>
  <div class="text-slate-800 text-center leading-relaxed">
    Challenge yourself with quick multiple-choice quizzes. Each question checks your comprehension of grammar, context, and word meaning.
  </div>
  <div class="bg-slate-200 text-slate-700 text-sm rounded-full px-3 py-1 self-center">story + popular + course</div>
</div>

  </div>

  <!-- üß© Active Quiz Section -->
  <div *ngIf="['Korean','Russian','Japanese','German','Italian'].includes(id) && quizStarted"
       class="w-full max-w-xl bg-gray-900 p-6 rounded-2xl mt-6 shadow-lg overflow-y-auto animate-fadeInUp">
    <!-- <timer></timer> -->

    <!-- üéß Control Buttons -->
    <div class="flex justify-center space-x-2 mb-4"><!--
      <button (click)="romanitization()" 
              class="bg-indigo-600 hover:bg-indigo-700 active:scale-95 px-4 py-2 rounded text-sm transition-transform duration-200">
        Pronunciation
      </button>
      <button *ngIf="['ko-to-en','ru-to-en','jp-to-en','itn-to-en','ge-to-en'].includes(direction)"
              (click)="playAudio(direction1 === direction ? phrases()[currentIndex].phrase : phrases()[currentIndex].en, direction1 === direction ? lang : 'en-US')"
              class="bg-cyan-500 hover:bg-cyan-600 active:scale-95 px-3 py-2 rounded text-sm transition-transform duration-200">
        üîä Play
      </button>-

      <div 
        *ngIf="'course'===m1"
        class="bg-cyan-500 hover:bg-cyan-600 active:scale-95 px-3 py-2 rounded text-sm transition-transform duration-200"
        (click)="highlight()">point 
      </div>-->
    
      
      <!-- <app-controls
        [showAudioButton]="['jp-to-en','itn-to-en','ko-to-en','ge-to-en','rus-to-en'].includes(direction)"
        [isCourse]="m1 === 'course'"
        (pronunciationToggled)="romanitization()"
        (audioPlayed)="playAudio(direction1 === direction ? phrases()[currentIndex].phrase : phrases()[currentIndex].en, direction1 === direction ? lang : 'en-US')"
        (highlightToggled)="highlight()"
        [showPronunciation]="pr"
        [m1]="m1">
      </app-controls> -->
    </div>
    <!-- ‚ùì Question Display -->
    <!-- üß† Question Section -->
<div
  class="relative bg-gradient-to-br from-[#0d1b2a] via-[#1b263b] to-[#0d1b2a]
         border border-cyan-400/40 backdrop-blur-md shadow-[0_0_25px_rgba(0,255,255,0.2)]
         p-6 rounded-2xl text-center mb-8 transition-all duration-500 animate-fadeIn">
  
  <!-- Question text -->
  <p class="text-2xl sm:text-3xl font-bold tracking-wide text-cyan-200 leading-snug">
    <span [innerHTML]="formatPhrase(direction1 === direction ? phrases()[currentIndex].phrase : phrases()[currentIndex].en + '')"></span>
  </p>

  <!-- Pronunciation -->
  <div class="text-base sm:text-lg text-blue-200 mt-2 transition-opacity duration-500 ease-in-out"
       [class.opacity-100]="pr"
       [class.opacity-0]="!pr">
    <span *ngIf="pr && ['ko-to-en','ru-to-en','itn-to-en','jp-to-en','ge-to-en'].includes(direction)"
          [innerHTML]="formatPhrase(phrases()[currentIndex][pro2] +'')"></span>
  </div>

  <!-- Decorative glow line -->
  <div class="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent animate-glowLine"></div>
</div>

<!-- üß© Answer Options -->
<div class="grid grid-cols-1 sm:grid-cols-2 gap-5 max-w-2xl mx-auto">
  <div *ngFor="let opt of options" class="flex flex-col items-center animate-slideUp">

    <button 
      (click)="selectAnswer(opt.text)"
      [ngClass]="{
        'bg-green-600 border border-green-400 shadow-[0_0_15px_rgba(34,197,94,0.4)] scale-105 text-white':
          opt.text===selectedOption && isCorrect === true,
        'bg-red-700 border border-red-400 shadow-[0_0_15px_rgba(239,68,68,0.4)] scale-95 text-white':
          opt.text===selectedOption && isCorrect === false
      }"
      class="w-full text-center p-4 rounded-xl font-semibold text-lg tracking-wide
             bg-gradient-to-br from-[#112b3c] to-[#0f172a]
             text-cyan-200 border border-cyan-700 hover:border-cyan-400
             hover:shadow-[0_0_15px_rgba(6,182,212,0.2)] transition-all duration-300 ease-out transform active:scale-95">
      
      <span [innerHTML]="formatPhrase(opt.text + '')"></span>

      <!-- Pronunciation for options -->
      <div class="text-sm text-blue-300 mt-1 transition-opacity duration-300"
           [class.opacity-100]="pr"
           [class.opacity-0]="!pr">
        <span *ngIf="pr && ['en-to-ko','en-to-jp','en-to-ru','en-to-itn','en-to-ge'].includes(direction)"
              [innerHTML]="formatPhrase(opt.pr)"></span>
      </div>
    </button>

    <!-- üîä Play Option -->
    <button *ngIf="['en-to-ko','en-to-jp','en-to-ru','en-to-itn','en-to-ge'].includes(direction)"
            (click)="playAudio(opt.text, lang)"
            class="mt-2 bg-cyan-600 hover:bg-cyan-500 active:scale-95 text-white 
                   px-3 py-1 rounded-full text-sm shadow-md flex items-center gap-1 transition-all duration-200">
      <span class="material-icons text-sm">volume_up</span> Play
    </button>
  </div>
    <app-controls
        [showAudioButton]="['jp-to-en','itn-to-en','ko-to-en','ge-to-en','ru-to-en'].includes(direction)" 
        [isCourse]="m1 === 'course'"
        (pronunciationToggled)="romanitization()"
        (audioPlayed)="playAudio(direction1 === direction ? phrases()[currentIndex].phrase : phrases()[currentIndex].en, direction1 === direction ? lang : 'en-US')"
        (highlightToggled)="highlight()"
        [showPronunciation]="pr"
        [m1]="m1">
      </app-controls>
</div>

    <!-- üßÆ Score --
    <p class="mt-6 text-center text-lg font-medium text-gray-300 animate-fadeInSlow">
      Score: <span class="text-blue-400 font-bold">{{ score }}</span>
    </p> 
  -->

    <!-- üîÅ Try Again -->
    <div *ngIf="quizFinished" class="mt-4 text-center animate-popIn">
      <p class="mb-2">{{score}} / {{phrases().length}}</p>
      <!--<button (click)="tryAgain()"
              class="bg-green-600 hover:bg-green-700 active:scale-95 text-white px-6 py-3 rounded-lg shadow transition-transform duration-200">
        üîÅ Try Again
      </button>-->
      <app-again 
        [correctCount]="correctAnswers.length"
        [wrongCount]="wrongAnswers.length"

        [select]="'choice'"
        [type]="m"
        [userResults]="userResults"
        (again)="tryAgain()"
        (retry)="toggleSidebar()">
      </app-again>                    
    <!-- ‚úÖ Results Display --
    <div *ngIf="showResults" class="p-6 rounded-lg bg-gray-100 shadow-md text-center">
      <h2 class="text-xl font-bold mb-4">Quiz Results</h2>
      <p class="text-lg">Score: {{ score }} / {{ phrases().length }}</p>

      <div class="mt-4 text-left">
        <h3 class="font-semibold text-green-600">‚úÖ Correct</h3>
        <ul class="list-disc ml-6">
          <li *ngFor="let c of correctAnswers">{{ formatPhrase(c[this.pro]) }} ‚Üí {{ c.en }}</li>
        </ul>

        <h3 class="font-semibold text-red-600 mt-4">‚ùå Wrong</h3>
        <ul class="list-disc ml-6">
          <li *ngFor="let w of wrongAnswers">{{ formatPhrase(w[this.pro]) }} ‚Üí {{ w.en }}</li>  
        </ul>
        </div> 

        <button 
          class="mt-6 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg" 
          (click)="openTryAgain()"> 
          Try Again 
        </button>
      </div>
        <!-- üåÄ Try Again Popup --
      <div *ngIf="showTryAgainPopup" class="fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-lg text-center">
          <h3 class="text-lg font-semibold mb-4">Try again?</h3>
          <button (click)="tryAgain()" class="bg-green-500 text-white px-4 py-2 rounded mr-2">Yes</button>
          <button (click)="closePopup()" class="bg-gray-400 text-white px-4 py-2 rounded">No</button>
        </div>
      </div>

    </div>-->
  </div>
</div>






