<!-- HEADER CARD -->
<header
  class="flex flex-col sm:flex-row justify-between items-start sm:items-center
         gap-3 p-4 bg-[#0F1F26] shadow-md text-cyan-100"
>
  <h2
    class="text-base sm:text-lg md:text-xl font-bold
           break-words max-w-full"
  >
    {{ selectedPhrases() === '' ? 'ðŸ“š Pick a list â†’' : 'Currently studying: ' + selectedPhrases() }}
  </h2>

  <button
    (click)="toggleSidebar()"
    class="bg-cyan-500 hover:bg-cyan-400
           text-white px-4 py-2
           rounded-lg shadow transition
           w-full sm:w-auto"
  >
    {{ sideBar ? 'âœ– Close' : 'â˜° Menu' }}
  </button>
</header>

<!-- SIDE MODAL -->
<app-s-model
  [sideBar]="sideBar"
  [m1]="m1"
  [phraseCourse]="phraseCourse"
  [phrasePopular]="phrasePopular"
  [phraseStory]="phraseStory"
  [selectedPhrases]="selectedPhrases"
  (closeModal)="close()"
  (selectPhrase)="getSpecificPhrases($event)">
</app-s-model>

<!-- START QUIZ -->
<div *ngIf="isReadyToStart && !quizStarted"
     class="text-center mt-6 px-3 animate-fade-in">

  <button
    (click)="startQuiz()"
    class="bg-gradient-to-r from-emerald-600 to-cyan-600
           hover:from-emerald-500 hover:to-cyan-500
           text-white px-8 py-3 rounded-xl shadow-lg
           text-lg font-semibold transition
           w-full sm:w-auto max-w-xs mx-auto"
  >
    â–¶ Start
  </button>

  <!-- DIRECTION BUTTONS -->
  <div class="flex flex-col sm:flex-row justify-center mt-6 gap-3 max-w-full">
    <button
      (click)="toggleDirectionMode(directionModeE)"
      [ngClass]="{
        'bg-cyan-700': directionMode===directionModeE,
        'bg-cyan-500': directionMode!==directionModeE
      }"
      class="a-btn w-full sm:w-auto"
    >
      {{ id }} â†’ English
    </button>

    <button
      (click)="toggleDirectionMode(directionModeC)"
      [ngClass]="{
        'bg-cyan-700': directionMode===directionModeC,
        'bg-cyan-500': directionMode!==directionModeC
      }"
      class="a-btn w-full sm:w-auto"
    >
      English â†’ {{ id }}
    </button>
  </div>

  <!-- INFO CARD -->
  <div
    class="bg-white shadow-md mt-6 rounded-2xl p-6
           mx-auto max-w-md flex flex-col gap-3
           hover:shadow-lg transition"
  >
    <h2 class="text-2xl font-bold text-slate-800 text-center">Card</h2>

    <p class="text-slate-700 text-center break-words">
      Study with interactive cards that disappear when answered correctly.
    </p>

    <p class="bg-slate-100 text-slate-600 p-3 rounded-lg text-center break-words">
      Study Japanese, Korean, Italian, Russian grammar efficiently.
    </p>

    <p class="text-slate-800 text-center leading-relaxed break-words">
      Adaptive learning that improves retention.
    </p>

    <span class="bg-slate-200 text-slate-700 text-sm rounded-full
                 px-3 py-1 self-center">
      story + popular + course
    </span>
  </div>
</div>

<!-- QUIZ SECTION -->
<div *ngIf="['Italian','Japanese','Korean','Russian','German'].includes(id) && quizStarted"
     class="text-white min-h-screen py-6 px-3 sm:px-4">

  <div *ngIf="remainingPhrases().length !== 0"
       class="mx-auto max-w-xl w-full mb-8
              bg-gray-800 rounded-2xl shadow-2xl
              border border-blue-500/30"
       [ngClass]="animationClass">

    <div class="flex flex-col gap-5 p-5 sm:p-7 text-center">

      <!-- QUESTION -->
      <span
        *ngIf="phraseOn"
        class="text-xl sm:text-2xl md:text-3xl
               font-semibold text-blue-300
               break-words leading-relaxed"
        [innerHTML]="formatPhrase(getQuestion() + '')">
      </span>

      <!-- PRONUNCIATION -->
      <p *ngIf="showPronunciation && directionMode === directionModeE"
         class="text-sm text-gray-300 italic break-words">
        <span [innerHTML]="formatPhrase(currentPhrase.pr + '')"></span>
      </p>

      <!-- REVEAL -->
      <button
        (click)="revealAnswer()"
        class="bg-blue-500 hover:bg-blue-600
               px-5 py-2 rounded-lg shadow
               text-sm w-full sm:w-auto max-w-xs mx-auto"
      >
        Reveal Answer
      </button>

      <!-- ANSWER -->
      <div *ngIf="showAnswer2"
           class="flex flex-col gap-4 pt-4 border-t border-gray-700">

        <span
          class="text-xl sm:text-2xl font-medium
                 text-emerald-300 break-words">
          {{ getAnswer() }}
        </span>

        <button
          *ngIf="directionMode === directionModeC"
          (click)="playAudio(currentPhrase.phrase, lang)"
          class="bg-indigo-600 hover:bg-indigo-700
                 px-5 py-2 rounded-lg text-sm
                 w-full sm:w-auto max-w-xs mx-auto"
        >
          â–¶ Play Audio
        </button>

        <!-- CONTROLS -->
        <div class="flex justify-center w-full">
          <div class="flex flex-wrap justify-center gap-3 max-w-full">
            <button *ngIf="answered()" (click)="next()" class="a-btn w-full sm:w-auto">Next</button>
            <button (click)="again()" class="a-btn bg-red-600 w-full sm:w-auto">Again</button>
            <button (click)="correct()" class="a-btn bg-emerald-600 w-full sm:w-auto">Correct</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Controls Component --> <app-controls [showPronunciation]="showPronunciation" [phraseOn]="phraseOn" [showPhraseButton]="['kor-to-eng','jp-to-eng','itn-to-eng','rus-to-eng','fr-to-eng'].includes(directionMode)" [showAudioButton]="['jp-to-eng','itn-to-eng','kor-to-eng','ge-to-eng','rus-to-eng'].includes(directionMode)" [isCourse]="m1 === 'course'" (pronunciationToggled)="togglePronunciation()" (phraseToggled)="phraseOnMode()" (audioPlayed)="playAudio(directionMode === directionModeE ? currentPhrase.phrase : currentPhrase.en, directionMode === directionModeE ? lang : 'en-US')" (highlightToggled)="toggleHighlight()"> </app-controls>
  <!-- PROGRESS -->
  <div class="mt-6 mx-auto max-w-xl px-2">
    <div class="w-full bg-gray-300 rounded-full h-3 overflow-hidden">
      <div class="bg-green-500 h-3 transition-all"
           [style.width.%]="(phrases().length - remainingPhrases().length) / phrases().length * 100">
      </div>

    </div>
    <p class="text-sm text-center text-gray-300 mt-2">
      {{ (phrases().length - remainingPhrases().length) / phrases().length * 100 }}% completed
  </div>
  <div *ngIf="remainingPhrases().length===0"> <app-again [select]="m" [type]="id" [userResults]="userResults" [correctCount]="0" [wrongCount]="0" (again)="startQuiz()" (retry)="toggleSidebar()"> </app-again> </div>
</div>
